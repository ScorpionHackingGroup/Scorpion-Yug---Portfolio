<!DOCTYPE html>
<html>
<head>
  <title>SassyNotes Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <link rel="stylesheet" href="adminpanel.css">
</head>
<body>
  <h1>Admin Panel</h1>

  <h2>Add/Edit Note</h2>
  <form id="note-form">
    <input type="hidden" id="note-id">
    Title: <input type="text" id="title" placeholder="Enter note title" required><br>
    Description: <input type="text" id="description" placeholder="Enter note description" required><br>
    Price (â‚¹): <input type="number" id="price" min="0" placeholder="Enter price in â‚¹" required><br>
    WhatsApp Number (international format): <input type="text" id="whatsapp" placeholder="Enter WhatsApp number (+91...)" required><br>
    Image URL: <input type="text" id="image" placeholder="Enter image URL" required><br>
    <button type="submit">Save Note</button>
  </form>

  <h2>All Notes</h2>
  <div id="admin-notes-list"></div>

  <h2>Change UPI ID</h2>
  <form id="upi-form">
    <input type="text" id="new-upi" placeholder="Enter new UPI ID" required>
    <button type="submit">Update UPI</button>
  </form>
  <p>Current UPI: <span id="current-upi"></span></p>

  <footer>
    Developed by <a href="https://t.me/ScorpionYug/" target="_blank">Scorpion Yug</a> & Zara ðŸ‡®ðŸ‡³
  </footer>

  <script>
    // Firebase Config (unchanged)
    const firebaseConfig = {
      apiKey: "AIzaSyDuWizv5P52KY73NEE_sb1S4xhOp2swogI",
      authDomain: "sassynotes-8270b.firebaseapp.com",
      projectId: "sassynotes-8270b",
      storageBucket: "sassynotes-8270b.firebasestorage.app",
      messagingSenderId: "81404740812",
      appId: "1:81404740812:web:4da9550da492b0ff0c2e69",
      measurementId: "G-VKBLEDQZX6"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const form = document.getElementById('note-form');
    const notesRef = db.ref('notes');

    // Submit Note
    form.onsubmit = (e) => {
      e.preventDefault();
      const id = form['note-id'].value;
      const note = {
        title: form.title.value,
        description: form.description.value,
        price: parseInt(form.price.value) || 0,
        whatsapp: form.whatsapp.value,
        image: form.image.value
      };
      if (id) {
        db.ref('notes/' + id).set(note);
      } else {
        db.ref('notes').push(note);
      }
      form.reset();
    };

    // Show Notes
    notesRef.on('value', snapshot => {
      const notes = snapshot.val();
      renderAdminNotes(notes);
    });

    function renderAdminNotes(notes) {
      const container = document.getElementById('admin-notes-list');
      container.innerHTML = '';
      if (!notes) {
        container.innerHTML = '<p>No notes found.</p>';
        return;
      }
      Object.keys(notes).forEach(id => {
        const d = notes[id];
        const el = document.createElement('div');
        el.innerHTML = `
          <h4>${d.title}</h4>
          ${d.image ? `<img src="${d.image}" width="200" style="max-width:100%;"><br>` : ''}
          <button onclick="editNote('${id}', \`${d.title}\`, \`${d.description}\`, \`${d.price}\`, \`${d.whatsapp}\`, \`${d.image || ''}\`)">Edit</button>
          <button onclick="deleteNote('${id}')">Delete</button>
        `;
        container.appendChild(el);
      });
    }

    // Edit Note
    window.editNote = function(id, title, description, price, whatsapp, image) {
      form['note-id'].value = id;
      form.title.value = title;
      form.description.value = description;
      form.price.value = price;
      form.whatsapp.value = whatsapp;
      form.image.value = image;
    }

    // Delete Note
    window.deleteNote = function(id) {
      if (confirm('Delete this note?')) {
        db.ref('notes/' + id).remove();
      }
    }

    // Update UPI
    const upiForm = document.getElementById('upi-form');
    const upiText = document.getElementById('current-upi');
    upiForm.onsubmit = function (e) {
      e.preventDefault();
      const newUPI = document.getElementById('new-upi').value;
      db.ref('settings/upi').set(newUPI);
      document.getElementById('new-upi').value = '';
    };

    // Listen for Realtime UPI Changes
    db.ref('settings/upi').on('value', snap => {
      if (snap.exists()) {
        upiText.textContent = snap.val();
      }
    });
  </script>
</body>
</html>